<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>vtacML.pipeline &#8212; vtacML  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=61cd365c" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=12dfc556" />
    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for vtacML.pipeline</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">yaml</span>
<span class="kn">import</span> <span class="nn">joblib</span>


<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span><span class="p">,</span> <span class="n">AdaBoostClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">Normalizer</span>

<span class="kn">from</span> <span class="nn">imblearn.over_sampling</span> <span class="kn">import</span> <span class="n">SMOTE</span>

<span class="kn">from</span> <span class="nn">yellowbrick</span> <span class="kn">import</span> <span class="n">ROCAUC</span>
<span class="kn">from</span> <span class="nn">yellowbrick.model_selection</span> <span class="kn">import</span> <span class="n">FeatureImportances</span><span class="p">,</span> <span class="n">ValidationCurve</span>
<span class="kn">from</span> <span class="nn">yellowbrick.classifier</span> <span class="kn">import</span> <span class="n">ClassificationReport</span><span class="p">,</span> <span class="n">ConfusionMatrix</span><span class="p">,</span> <span class="n">PrecisionRecallCurve</span><span class="p">,</span> <span class="n">ClassPredictionError</span>
<span class="kn">from</span> <span class="nn">yellowbrick.model_selection</span> <span class="kn">import</span> <span class="n">RFECV</span>

<span class="kn">from</span> <span class="nn">.preparation</span> <span class="kn">import</span> <span class="n">Cleaner</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">get_path</span>

<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<div class="viewcode-block" id="predict_from_best_pipeline">
<a class="viewcode-back" href="../../modules.html#vtacML.pipeline.predict_from_best_pipeline">[docs]</a>
<span class="k">def</span> <span class="nf">predict_from_best_pipeline</span><span class="p">(</span><span class="n">X</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">prob_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="s1">&#39;0.974_rfc_best_model.pkl&#39;</span><span class="p">,</span>
                               <span class="n">config_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Predict using the best model pipeline.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X : array-like</span>
<span class="sd">            Features to predict.</span>
<span class="sd">        prob_flag : bool, optional</span>
<span class="sd">            Whether to return probabilities, by default False.</span>
<span class="sd">        model_name : str, optional</span>
<span class="sd">            Name of the model to use, by default &#39;0.974_rfc_best_model.pkl&#39;</span>
<span class="sd">        model_path : str, optional</span>
<span class="sd">            Path to the model to use for prediction, by default &#39;None&#39;</span>
<span class="sd">        config_path : str, optional</span>
<span class="sd">            Path to the configuration file, by default &#39;../config/config.yaml&#39;.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ndarray</span>
<span class="sd">            Predicted values or probabilities.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="n">vtac_ml_pipe</span> <span class="o">=</span> <span class="n">VTACMLPipe</span><span class="p">(</span><span class="n">config_file</span><span class="o">=</span><span class="n">config_path</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
    <span class="n">vtac_ml_pipe</span><span class="o">.</span><span class="n">load_best_model</span><span class="p">(</span><span class="n">model_name</span><span class="o">=</span><span class="n">model_name</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">vtac_ml_pipe</span><span class="o">.</span><span class="n">best_model</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">vtac_ml_pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">prob_flag</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span></div>



<div class="viewcode-block" id="VTACMLPipe">
<a class="viewcode-back" href="../../modules.html#vtacML.pipeline.VTACMLPipe">[docs]</a>
<span class="k">class</span> <span class="nc">VTACMLPipe</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A machine learning pipeline for training and evaluating an optimal model for optical identification of GRBs for the SVOM mission.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    config_path : str, optional</span>
<span class="sd">        Path to the configuration file. Default &#39;config/config.yaml&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_file</span><span class="o">=</span><span class="s1">&#39;config/config.yaml&#39;</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the VTACMLPipe.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        config_path : str</span>
<span class="sd">            Path to the configuration file.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># initialize attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X_columns</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_columns</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X_train</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_train</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X_test</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_test</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preprocessing</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">full_pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">best_model</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_predict</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_predict_prob</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Load configs from config file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_config</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span>

        <span class="c1"># Defining Steps of the preprocessing pipeline</span>
        <span class="n">cleaner</span> <span class="o">=</span> <span class="n">Cleaner</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X_columns</span><span class="p">)</span>
        <span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
        <span class="n">normalizer</span> <span class="o">=</span> <span class="n">Normalizer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s1">&#39;cleaner&#39;</span><span class="p">,</span> <span class="n">cleaner</span><span class="p">),</span>
            <span class="c1"># (&#39;ohe&#39;, ohe),</span>
            <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;normalizer&#39;</span><span class="p">,</span> <span class="n">normalizer</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_pipe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">)</span>

<div class="viewcode-block" id="VTACMLPipe.load_config">
<a class="viewcode-back" href="../../modules.html#vtacML.pipeline.VTACMLPipe.load_config">[docs]</a>
    <span class="k">def</span> <span class="nf">load_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_file</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">           Load the configuration file and prepare the data.</span>

<span class="sd">           Parameters</span>
<span class="sd">           ----------</span>
<span class="sd">           config_file : str</span>
<span class="sd">               The path to the configuration file.</span>

<span class="sd">           &quot;&quot;&quot;</span>
        <span class="n">config_path</span> <span class="o">=</span> <span class="n">get_path</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

        <span class="c1"># loading config file and prepping data</span>
        <span class="n">data_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Inputs&#39;</span><span class="p">][</span><span class="s1">&#39;file&#39;</span><span class="p">]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data</span><span class="p">(</span><span class="n">data_file</span><span class="o">=</span><span class="n">data_file</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">X_columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Inputs&#39;</span><span class="p">][</span><span class="s1">&#39;columns&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">X_columns</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Inputs&#39;</span><span class="p">][</span><span class="s1">&#39;target_column&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">y_columns</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X_columns</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">y_columns</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

        <span class="c1"># building models attribute</span>
        <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Models&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;rfc&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;svc&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;knn&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;lr&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;dt&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;ada&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="n">AdaBoostClassifier</span><span class="p">()</span></div>


<div class="viewcode-block" id="VTACMLPipe.train">
<a class="viewcode-back" href="../../modules.html#vtacML.pipeline.VTACMLPipe.train">[docs]</a>
    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_all_model</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">resample_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Train the pipeline with the given data.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        save_all_model : bool, optional</span>
<span class="sd">            Whether to save best model of each model type to output directory. Default is False.</span>
<span class="sd">        resample_flag : bool, optional</span>
<span class="sd">            Whether to resample the data. Default is False</span>
<span class="sd">        scoring : str, optional</span>
<span class="sd">            The scoring function to use. Default is &#39;f1&#39;.</span>
<span class="sd">        cv : int, optional</span>
<span class="sd">            The cross-validation split to use. Default is 5.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Pipeline</span>
<span class="sd">            Trained machine learning pipeline.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span>

        <span class="k">if</span> <span class="n">resample_flag</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">X_train</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_train</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resample</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_train</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">steps</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No preprocessing steps&quot;</span><span class="p">)</span>
        <span class="n">model_path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">best_score</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

            <span class="n">param_grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Models&#39;</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;param_grid&#39;</span><span class="p">]</span>

            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Model: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">full_pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">steps</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">full_pipeline</span><span class="o">.</span><span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">model</span><span class="p">))</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">full_pipeline</span><span class="o">.</span><span class="n">steps</span><span class="p">)</span>

            <span class="c1"># model fitting</span>
            <span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">full_pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">scoring</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">)</span>
            <span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_train</span><span class="p">)</span>

            <span class="n">model_filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">grid_search</span><span class="o">.</span><span class="n">best_score_</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_best_model.pkl&#39;</span>
            <span class="n">model_path</span> <span class="o">=</span> <span class="n">get_path</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;output/models/</span><span class="si">{</span><span class="n">model_filename</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">save_all_model</span><span class="p">:</span>
                <span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span>
                    <span class="n">grid_search</span><span class="o">.</span><span class="n">best_estimator_</span><span class="p">,</span>
                    <span class="n">model_path</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_score_</span> <span class="o">&gt;</span> <span class="n">best_score</span><span class="p">:</span>
                <span class="n">best_score</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_score_</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">best_model</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_estimator_</span>

            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;*&#39;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Best </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> Pipeline:&#39;</span><span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">grid_search</span><span class="o">.</span><span class="n">best_estimator_</span><span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Best Score: </span><span class="si">{</span><span class="n">grid_search</span><span class="o">.</span><span class="n">best_score_</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;*&#39;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Overall best model: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">best_model</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span></div>


        <span class="c1"># self.save_best_model(model_path=model_path)</span>

<div class="viewcode-block" id="VTACMLPipe.save_best_model">
<a class="viewcode-back" href="../../modules.html#vtacML.pipeline.VTACMLPipe.save_best_model">[docs]</a>
    <span class="k">def</span> <span class="nf">save_best_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="s1">&#39;best_model&#39;</span><span class="p">,</span> <span class="n">model_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Saves best model from training to the specified path in the config file. Optionally change name and/or path</span>
<span class="sd">            of the model.</span>

<span class="sd">            Parameters</span>
<span class="sd">            -------</span>
<span class="sd">            model_name : str, optional</span>
<span class="sd">                Name of the model to be saved. Default=&#39;best_model&#39;.</span>
<span class="sd">            model_path : str, optional</span>
<span class="sd">                Path to the model to be saved. Default=&#39;model_path&#39; in config file</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">model_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">model_path</span> <span class="o">=</span> <span class="n">get_path</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Outputs&#39;</span><span class="p">][</span><span class="s1">&#39;model_path&#39;</span><span class="p">]</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>
            <span class="n">model_path</span> <span class="o">=</span> <span class="n">get_path</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>

        <span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">best_model</span><span class="p">,</span> <span class="n">model_path</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Saved model to </span><span class="si">{</span><span class="n">model_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="VTACMLPipe.load_best_model">
<a class="viewcode-back" href="../../modules.html#vtacML.pipeline.VTACMLPipe.load_best_model">[docs]</a>
    <span class="k">def</span> <span class="nf">load_best_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Loads &#39;model_name&#39; into current pipeline.</span>

<span class="sd">            Parameters</span>
<span class="sd">            -------</span>
<span class="sd">            model_name : str</span>
<span class="sd">                The name of the model from the Outputs/models/ directory to be loaded.</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">model_path</span> <span class="o">=</span> <span class="n">get_path</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Outputs&#39;</span><span class="p">][</span><span class="s1">&#39;model_path&#39;</span><span class="p">]</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">best_model</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Loaded </span><span class="si">{</span><span class="n">model_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="VTACMLPipe.evaluate">
<a class="viewcode-back" href="../../modules.html#vtacML.pipeline.VTACMLPipe.evaluate">[docs]</a>
    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">score</span><span class="o">=</span><span class="n">f1_score</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Evaluate the best model with various metrics and visualization.</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            name : str</span>
<span class="sd">                The name for the evaluation output.</span>
<span class="sd">            plot : bool, optional</span>
<span class="sd">                If True, generates and saves evaluation plots, by default False.</span>
<span class="sd">            score : callable, optional</span>
<span class="sd">                The scoring function to use for evaluation, by default f1_score.</span>

<span class="sd">            &quot;&quot;&quot;</span>
        <span class="n">viz_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Outputs&#39;</span><span class="p">][</span><span class="s1">&#39;viz_path&#39;</span><span class="p">]</span>
        <span class="n">output_path</span> <span class="o">=</span> <span class="n">get_path</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">viz_path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">best_model</span><span class="o">.</span><span class="n">steps</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">output_path</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Folder &#39;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s2">&#39; created.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Folder &#39;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s2">&#39; already exists.&quot;</span><span class="p">)</span>
        <span class="c1"># INCLUDE case in titles</span>
        <span class="c1"># model scoring</span>
        <span class="c1">#</span>
        <span class="c1"># if self.best_model.steps[-1][0] == &#39;knn&#39; and plot:</span>
        <span class="c1">#     print(&#39;plotting&#39;)</span>
        <span class="c1">#     self.preprocessing.fit(self.X)</span>
        <span class="c1">#     X = pd.DataFrame(self.preprocessing.transform(self.X))</span>
        <span class="c1">#     self.plot_knn_neighbors(knn=self.best_model.steps[-1][1], X=X, y=self.y, features=self.X_columns)</span>
        <span class="c1">#     print(&#39;done plotting&#39;)</span>
        <span class="c1"># else:</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">best_model</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># Evaluate model performance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_print_model_eval</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>

            <span class="n">_</span><span class="p">,</span> <span class="n">ax_report</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

            <span class="n">report_viz</span> <span class="o">=</span> <span class="n">ClassificationReport</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">best_model</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;NOT_GRB&quot;</span><span class="p">,</span> <span class="s2">&quot;IS_GRB&quot;</span><span class="p">],</span> <span class="n">support</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                              <span class="n">ax</span><span class="o">=</span><span class="n">ax_report</span><span class="p">)</span>
            <span class="n">report_viz</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_train</span><span class="p">)</span>  <span class="c1"># Fit the visualizer and the model</span>
            <span class="n">report_viz</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_test</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_test</span><span class="p">)</span>  <span class="c1"># Evaluate the model on the test data</span>
            <span class="n">report_viz</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">outpath</span><span class="o">=</span><span class="n">output_path</span> <span class="o">+</span> <span class="s1">&#39;/classification_report.pdf&#39;</span><span class="p">)</span>

            <span class="n">_</span><span class="p">,</span> <span class="n">ax_cm_test</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

            <span class="n">cm_test_viz</span> <span class="o">=</span> <span class="n">ConfusionMatrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">best_model</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;NOT_GRB&quot;</span><span class="p">,</span> <span class="s2">&quot;IS_GRB&quot;</span><span class="p">],</span> <span class="n">percent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax_cm_test</span><span class="p">)</span>
            <span class="n">cm_test_viz</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_train</span><span class="p">)</span>
            <span class="n">cm_test_viz</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_test</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_test</span><span class="p">)</span>
            <span class="n">cm_test_viz</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">outpath</span><span class="o">=</span><span class="n">output_path</span> <span class="o">+</span> <span class="s1">&#39;/confusion_matrix_test.pdf&#39;</span><span class="p">)</span>

            <span class="n">_</span><span class="p">,</span> <span class="n">ax_cm_train</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

            <span class="n">cm_train_viz</span> <span class="o">=</span> <span class="n">ConfusionMatrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">best_model</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;NOT_GRB&quot;</span><span class="p">,</span> <span class="s2">&quot;IS_GRB&quot;</span><span class="p">],</span> <span class="n">percent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_cm_train</span><span class="p">)</span>
            <span class="n">cm_train_viz</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_train</span><span class="p">)</span>
            <span class="n">cm_train_viz</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_train</span><span class="p">)</span>
            <span class="n">cm_train_viz</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">outpath</span><span class="o">=</span><span class="n">output_path</span> <span class="o">+</span> <span class="s1">&#39;/confusion_matrix_train.pdf&#39;</span><span class="p">)</span>

            <span class="n">_</span><span class="p">,</span> <span class="n">ax_roc</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

            <span class="n">roc_viz</span> <span class="o">=</span> <span class="n">ROCAUC</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">best_model</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;NOT_GRB&quot;</span><span class="p">,</span> <span class="s2">&quot;IS_GRB&quot;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_roc</span><span class="p">)</span>
            <span class="n">roc_viz</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_train</span><span class="p">)</span>  <span class="c1"># Fit the training data to the visualizer</span>
            <span class="n">roc_viz</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_test</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_test</span><span class="p">)</span>  <span class="c1"># Evaluate the model on the test data</span>
            <span class="n">roc_viz</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">outpath</span><span class="o">=</span><span class="n">output_path</span> <span class="o">+</span> <span class="s1">&#39;/ROC_AUC.pdf&#39;</span><span class="p">)</span>

            <span class="n">_</span><span class="p">,</span> <span class="n">ax_pr_curve</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

            <span class="n">pr_curve_viz</span> <span class="o">=</span> <span class="n">PrecisionRecallCurve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">best_model</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;NOT_GRB&quot;</span><span class="p">,</span> <span class="s2">&quot;IS_GRB&quot;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_pr_curve</span><span class="p">)</span>
            <span class="n">pr_curve_viz</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_train</span><span class="p">)</span>
            <span class="n">pr_curve_viz</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_test</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_test</span><span class="p">)</span>
            <span class="n">pr_curve_viz</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">outpath</span><span class="o">=</span><span class="n">output_path</span> <span class="o">+</span> <span class="s1">&#39;/PR_curve.pdf&#39;</span><span class="p">)</span>

            <span class="n">_</span><span class="p">,</span> <span class="n">ax_class_pred</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
            <span class="n">ax_class_pred</span><span class="o">.</span><span class="n">semilogy</span><span class="p">()</span>

            <span class="n">class_pred_viz</span> <span class="o">=</span> <span class="n">ClassPredictionError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">best_model</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;NOT_GRB&quot;</span><span class="p">,</span> <span class="s2">&quot;IS_GRB&quot;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_class_pred</span><span class="p">)</span>
            <span class="n">class_pred_viz</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_train</span><span class="p">)</span>
            <span class="n">class_pred_viz</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_test</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_test</span><span class="p">)</span>
            <span class="n">class_pred_viz</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">outpath</span><span class="o">=</span><span class="n">output_path</span> <span class="o">+</span> <span class="s1">&#39;/class_predictions.pdf&#39;</span><span class="p">)</span>
            <span class="c1">#</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">best_model</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">RandomForestClassifier</span><span class="p">():</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">ax_feature_imp</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

                <span class="n">feature_imp_viz</span> <span class="o">=</span> <span class="n">FeatureImportances</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">best_model</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_feature_imp</span><span class="p">)</span>
                <span class="n">feature_imp_viz</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
                <span class="n">feature_imp_viz</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">outpath</span><span class="o">=</span><span class="n">output_path</span> <span class="o">+</span> <span class="s1">&#39;/feature_importances.pdf&#39;</span><span class="p">)</span></div>

        <span class="c1"># if plot_extra:</span>
        <span class="c1">#     self.hyperparameter_valid_curve(outpath=output_path)</span>
        <span class="c1">#     # self.recursive_feature_elimination_plot(outpath=output_path)</span>
        <span class="c1">#</span>

<div class="viewcode-block" id="VTACMLPipe.predict">
<a class="viewcode-back" href="../../modules.html#vtacML.pipeline.VTACMLPipe.predict">[docs]</a>
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Predict using the best model.</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            X : DataFrame</span>
<span class="sd">                The input features for prediction.</span>
<span class="sd">            prob : bool, optional</span>
<span class="sd">                If True, returns the probability of the predictions, by default False.</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            ndarray</span>
<span class="sd">                The predicted values or probabilities.</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">X_columns</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">prob</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y_predict_prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">best_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_predict_prob</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y_predict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">best_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_predict</span></div>


    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_data</span><span class="p">(</span><span class="n">data_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Load data from a parquet file.</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            data_file : str</span>
<span class="sd">                The name of the data file to load.</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            DataFrame</span>
<span class="sd">                The loaded data.</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="n">data_path</span> <span class="o">=</span> <span class="n">get_path</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;/data/</span><span class="si">{</span><span class="n">data_file</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;fastparquet&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span>

    <span class="k">def</span> <span class="nf">_load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">test_size</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load the data from the source specified in the config.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data : pd.DataFrame</span>
<span class="sd">            The data to load.</span>
<span class="sd">        columns : list</span>
<span class="sd">            The columns to load.</span>
<span class="sd">        target: str</span>
<span class="sd">            The target column.</span>
<span class="sd">        test_size: float, optional</span>
<span class="sd">            The size of the test sample as a fraction of the total sample. Default is 0.2.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        DataFrame</span>
<span class="sd">            Loaded data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">target</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_split_data</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_split_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Split data into training and testing sets.</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            X : DataFrame</span>
<span class="sd">                The input features.</span>
<span class="sd">            y : array-like</span>
<span class="sd">                The target values.</span>
<span class="sd">            test_size : float</span>
<span class="sd">                The proportion of the dataset to include in the test split.</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">X_test</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">y_train</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">y_test</span><span class="p">)</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
                                         <span class="n">test_size</span><span class="o">=</span><span class="n">test_size</span><span class="p">,</span>
                                         <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>

        <span class="c1"># _, ax_class_balance = plt.subplots()</span>
        <span class="c1"># ax_class_balance.semilogy()</span>
        <span class="c1"># class_balance_visualizer = ClassBalance(labels=[&quot;NOT_GRB&quot;, &quot;GRB&quot;], ax=ax_class_balance,</span>
        <span class="c1">#                                         kwargs={&#39;verbose&#39;: 2})</span>
        <span class="c1"># class_balance_visualizer.fit(self.y_train, self.y_test)  # Fit the data to the visualizer</span>
        <span class="c1"># class_balance_visualizer.show(outpath=&#39;/output/visualizations/class_balance.pdf&#39;)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_resample</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Resamples the input data</span>

<span class="sd">            Parameters</span>
<span class="sd">            -------</span>
<span class="sd">            X : pd.DataFrame</span>
<span class="sd">                input data</span>
<span class="sd">            y : pd.Series</span>
<span class="sd">                input label</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            X_ : pd.DataFrame</span>
<span class="sd">                resampled data</span>
<span class="sd">            y_ : pd.Series</span>
<span class="sd">                resampled label</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sm</span> <span class="o">=</span> <span class="n">SMOTE</span><span class="p">(</span><span class="n">sampling_strategy</span><span class="o">=</span><span class="s1">&#39;minority&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
        <span class="n">X_</span><span class="p">,</span> <span class="n">y_</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">X_</span><span class="p">,</span> <span class="n">y_</span>

    <span class="k">def</span> <span class="nf">_create_pipe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create the machine learning pipeline from the given steps.</span>

<span class="sd">        Parameters</span>
<span class="sd">        -------</span>
<span class="sd">        steps : list</span>
<span class="sd">            The steps to use for the machine learning preprocessing pipeline.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Pipeline</span>
<span class="sd">            The created machine learning pipeline.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">steps</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_print_model_eval</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints the evaluation of the model, mean average error (MAE), root mean squared error (RMSE),</span>
<span class="sd">        f1 score and confusion matrices for training and testing datasets.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">train_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">best_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train</span><span class="p">)</span>
        <span class="n">test_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">best_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_test</span><span class="p">)</span>

        <span class="n">train_conf_matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_train</span><span class="p">,</span> <span class="n">train_pred</span><span class="p">)</span>
        <span class="n">test_conf_matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_pred</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*&#39;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Training score:&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;MAE: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_train</span><span class="p">,</span><span class="w"> </span><span class="n">train_pred</span><span class="p">),</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s1"> &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;| RMSE: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_train</span><span class="p">,</span><span class="w"> </span><span class="n">train_pred</span><span class="p">,</span><span class="w"> </span><span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s1"> &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;| F1: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">f1_score</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_train</span><span class="p">,</span><span class="w"> </span><span class="n">train_pred</span><span class="p">),</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Confusion Matrix:&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">train_conf_matrix</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Validation score:&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;MAE: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_test</span><span class="p">,</span><span class="w"> </span><span class="n">test_pred</span><span class="p">),</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s1"> &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;| RMSE: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_test</span><span class="p">,</span><span class="w"> </span><span class="n">test_pred</span><span class="p">,</span><span class="w"> </span><span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s1"> &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;| F1: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">f1_score</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_test</span><span class="p">,</span><span class="w"> </span><span class="n">test_pred</span><span class="p">),</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Confusion Matrix:&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">test_conf_matrix</span><span class="p">)</span></div>


<span class="c1"># def hyperparameter_valid_curve(self, outpath):</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#         Validate hyperparameters and generate validation curves.</span>
<span class="c1">#</span>
<span class="c1">#         Parameters</span>
<span class="c1">#         ----------</span>
<span class="c1">#         outpath : str</span>
<span class="c1">#             The output path where the validation curve plots will be saved.</span>
<span class="c1">#</span>
<span class="c1">#         Returns</span>
<span class="c1">#         -------</span>
<span class="c1">#         None</span>
<span class="c1">#         &quot;&quot;&quot;</span>
<span class="c1">#     best_model_name = self.best_model.steps[-1][0]</span>
<span class="c1">#     param_grid = self.config[&#39;Models&#39;][best_model_name][&#39;param_grid&#39;]</span>
<span class="c1">#     for param in param_grid:</span>
<span class="c1">#         # self.preprocessing.fit(self.X, self.y)</span>
<span class="c1">#         # processed_X = self.preprocessing.transform(self.X)</span>
<span class="c1">#         # processed_y = self.y</span>
<span class="c1">#         param_range = param_grid[param]</span>
<span class="c1">#         param_name = param.split(&#39;__&#39;)[1]</span>
<span class="c1">#         print(f&#39;Validating {param_name} over range {param_range}&#39;)</span>
<span class="c1">#         _, ax_valid_curve = plt.subplots()</span>
<span class="c1">#</span>
<span class="c1">#         valid_curve_viz = ValidationCurve(self.best_model,</span>
<span class="c1">#                                           param_name=param,</span>
<span class="c1">#                                           param_range=param_range,</span>
<span class="c1">#                                           cv=5,</span>
<span class="c1">#                                           scoring=&quot;f1&quot;,</span>
<span class="c1">#                                           ax=ax_valid_curve</span>
<span class="c1">#                                           )</span>
<span class="c1">#         valid_curve_viz.fit(self.X, self.y)</span>
<span class="c1">#         valid_curve_viz.show(outpath=f&#39;{outpath}/{param_name}_valid_curve.pdf&#39;)</span>
<span class="c1">#</span>
<span class="c1"># def recursive_feature_elimination_plot(self, outpath):</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#        Generate a recursive feature elimination plot.</span>
<span class="c1">#</span>
<span class="c1">#        Parameters</span>
<span class="c1">#        ----------</span>
<span class="c1">#        outpath : str</span>
<span class="c1">#            The output path where the feature elimination plot will be saved.</span>
<span class="c1">#</span>
<span class="c1">#        Returns</span>
<span class="c1">#        -------</span>
<span class="c1">#        None</span>
<span class="c1">#        &quot;&quot;&quot;</span>
<span class="c1">#     _, ax_feature_elimination = plt.subplots()</span>
<span class="c1">#     visualizer = RFECV(self.best_model.steps[-1][1], cv=5, scoring=&#39;f1_weighted&#39;, ax=ax_feature_elimination)</span>
<span class="c1">#     visualizer.fit(self.X, self.y)  # Fit the data to the visualizer</span>
<span class="c1">#     visualizer.show(outpath=outpath + &#39;feature_elimination.pdf&#39;)</span>
<span class="c1">#</span>
<span class="c1"># @staticmethod</span>
<span class="c1"># def plot_knn_neighbors(knn, X, y, features):</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#         Plot the KNN neighbors for a given dataset.</span>
<span class="c1">#</span>
<span class="c1">#         Parameters</span>
<span class="c1">#         ----------</span>
<span class="c1">#         knn : KNeighborsClassifier</span>
<span class="c1">#             The KNN classifier.</span>
<span class="c1">#         X : DataFrame</span>
<span class="c1">#             The dataset containing the features.</span>
<span class="c1">#         y : array-like</span>
<span class="c1">#             The target values.</span>
<span class="c1">#         features : list</span>
<span class="c1">#             List of feature names to plot.</span>
<span class="c1">#</span>
<span class="c1">#         Returns</span>
<span class="c1">#         -------</span>
<span class="c1">#         None</span>
<span class="c1">#         &quot;&quot;&quot;</span>
<span class="c1">#</span>
<span class="c1">#     # Select a random point</span>
<span class="c1">#     random_index = np.random.randint(0, len(X))</span>
<span class="c1">#     random_point = X.iloc[random_index]</span>
<span class="c1">#</span>
<span class="c1">#     # Find the neighbors of the random point</span>
<span class="c1">#     neighbors = knn.kneighbors([random_point], return_distance=False)</span>
<span class="c1">#</span>
<span class="c1">#     # Plot each pair of features</span>
<span class="c1">#     num_features = len(features)</span>
<span class="c1">#     for i in range(num_features):</span>
<span class="c1">#         for j in range(i + 1, num_features):</span>
<span class="c1">#             plt.figure(figsize=(8, 6))</span>
<span class="c1">#             plt.scatter(X.iloc[:, i], X.iloc[:, j], c=y, cmap=&#39;viridis&#39;, marker=&#39;o&#39;, edgecolor=&#39;k&#39;, s=50)</span>
<span class="c1">#             plt.scatter(random_point[i], random_point[j], c=&#39;red&#39;, marker=&#39;x&#39;, s=200, label=&#39;Random Point&#39;)</span>
<span class="c1">#             plt.scatter(X.iloc[neighbors[0], i], X.iloc[neighbors[0], j], c=&#39;red&#39;, marker=&#39;o&#39;, edgecolor=&#39;k&#39;, s=100,</span>
<span class="c1">#                         facecolors=&#39;none&#39;, label=&#39;Neighbors&#39;)</span>
<span class="c1">#             plt.xlabel(features[i])</span>
<span class="c1">#             plt.ylabel(features[j])</span>
<span class="c1">#             plt.title(f&#39;KNN Neighbors with {features[i]} vs {features[j]}&#39;)</span>
<span class="c1">#             plt.legend()</span>
<span class="c1">#             plt.savefig(</span>
<span class="c1">#                 f&#39;/output/visualizations/knn_plots/{features[i]}_vs_{features[j]}_knn_neighbors.pdf&#39;</span>
<span class="c1">#             )</span>


</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">vtacML</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">Docs vtacML</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Jeremy Palmerio.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
    </div>

    

    
  </body>
</html>